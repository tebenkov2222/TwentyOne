# TwentyOne

Данный проект был создан для тестирования серверной логики для игры RussianMunchkin по этому namespace и директории по всему проекту содержат отсылки на RussianMunchkin

Проект состоит из 2 частей: CLient и Server

## Client

Клиент собран на Unity 2021.3.20f1
При разработке старался максимально отделить бизнес логику и визуал Программа запускается через EntryPoint и далее создает все необходимые модули. За View отвечает UiManager

## Server

На данный момент сервера отключены.

Данное решение состоит из 4 частей - Common, Server, ServerFramewor, Repository

### ServerFramework

В проекте ServerFramework находится базовая реализация приема - передачи пакетов между клиентом и сервером. В качестве частной реализации использовал библиотеку LiteNetLib

### Server

В проекте Server находится сама логика работы с клиентами и запуска игр
Весь сервер запускается через EntryPoint.

Сделана полная авторизация по логину и паролю. Пароль хешируется и храниться в базе данных хешированным. Данные сохраняются в postgresql

Матчмейкинг работает по принципу комнат. Определенный пользователь при желании может подключиться к определенной комнате или создать комнату для дальнейшего набора игроков

Также вынесен отдельный конфигурационный файл congig.json для хранения настроек подключения и работы сервера.

### Common

В проекте Common находятся общие части между клиентом и сервером, такие как: таски для приема ответа на запрос, пакеты, модуль управления временем

### Reposityry

В данном проекте находится логика общения с базой данных.

### Сборка

Проект собирается при помощи dotnet и пакуется в linux docker container для запуска на сервере

Запуск происходит при помощи файла [docker-compose.yml](https://github.com/tebenkov2222/TwentyOne/blob/main/RussianMunchkin.Server/RussianMunchkin.Server/docker-compose/Full/docker-compose.yml)

## Метрики

К данному проекту также подключены минимальные метрики при помощи Prometheus и Grafana. 

## Postgresql 

К проекту также подключен postgresql для хранения данных пользователя. При старте контейнера с бд происходит автогенерация по database.sql
